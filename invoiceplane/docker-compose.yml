# InvoicePlane 1.7.0 - Open Source Invoicing
# ~/docker/invoiceplane/docker-compose.yml
# Entrypoint downloads 1.7.0 on first run, shared-apache serves static files

services:
  # PHP-FPM container (entrypoint handles init/download on first run)
  invoiceplane:
    build:
      context: .
      dockerfile: Dockerfile
    image: invoiceplane-fpm:1.7.0-php8.4
    container_name: invoiceplane
    restart: unless-stopped
    deploy:
      resources:
        limits:
          memory: 384m
        reservations:
          memory: 192m
    volumes:
      - invoiceplane-code:/var/www/invoiceplane
      - invoiceplane-uploads:/var/www/invoiceplane/uploads
    environment:
      - TZ=UTC
    networks:
      - shared-db

volumes:
  invoiceplane-code:
  invoiceplane-uploads:

networks:
  shared-db:
    external: true
